{"version":3,"sources":["node_modules/browser-split/index.js","node_modules/indexof/index.js","node_modules/class-list/index.js","node_modules/hyperscript/index.js","node_modules/object-assign/index.js","node_modules/@sanity/generate-help-url/index.js","../src/parseSource.js","../src/parseAssetId.js","../src/urlForImage.js","../src/builder.js","node_modules/@sanity/image-url/index.js","../src/getImageUrl.js","../src/buildMarksTree.js","../src/nestLists.js","../src/generateKeys.js","../src/mergeSerializers.js","../src/blocksToNodes.js","../src/serializers.js","../src/index.js","../src/blocksToHtml.js","projects.js","main.js"],"names":["getOwnPropertySymbols","Object","hasOwnProperty","prototype","propIsEnumerable","propertyIsEnumerable","toObject","val","TypeError","shouldUseNative","assign","test1","String","getOwnPropertyNames","test2","i","fromCharCode","order2","map","n","join","test3","split","forEach","letter","keys","err","module","exports","target","source","from","symbols","to","s","arguments","length","key","call","parseSource","image","isUrl","asset","_ref","urlToId","_id","url","crop","hotspot","applyDefaults","test","parts","slice","replace","left","top","bottom","right","x","y","height","width","example","parseAssetId","ref","id","dimensionString","format","Error","isFinite","SPEC_NAME_TO_URL_NAME_MAPPINGS","urlForImage","options","spec","Math","round","hotSpotVerticalRadius","hotSpotHorizontalRadius","hotSpotCenterX","hotSpotCenterY","rect","focalPoint","ignoreImageParams","fit","specToImageUrl","cdnUrl","baseUrl","filename","projectId","dataset","params","push","bg","flipHorizontal","flipVertical","mapping","specName","param","encodeURIComponent","result","desiredAspectRatio","max","floor","validFits","validCrops","ImageUrlBuilder","parent","withOptions","maxWidth","minWidth","maxHeight","minHeight","blur","sharpen","invert","orientation","quality","download","value","indexOf","urlBuilder","clientConfig","apiHost","generateHelpUrl","require","objectAssign","enc","materializeError","getQueryString","query","imageOptions","buildUrl","node","props","toString","defaultMarks","buildMarksTree","children","block","markDefs","sortedMarks","sortMarksByOccurences","rootNode","_type","nodeStack","span","marksNeeded","pos","mark","markKey","index","splice","currentNode","findLastParentNode","_key","find","def","isTextSpan","lines","text","line","concat","spans","marks","markOccurences","reduce","occurences","siblingIndex","sibling","Array","isArray","sortByOccurence","sortMarks","bind","sort","markA","markB","aOccurences","bOccurences","aDefaultPos","bDefaultPos","nodes","nestLists","blocks","mode","tree","currentList","isListBlock","blockMatchesList","level","newList","listFromBlock","lastListItem","lastChild","newLastChild","match","findListMatching","listItem","console","warn","Boolean","list","matching","filterOnType","getStaticKey","item","checksum","JSON","stringify","str","hash","strlen","charCodeAt","isDefined","defaultSerializers","userSerializers","acc","type","generateKeys","mergeSerializers","optionProps","defaults","blocksToNodes","h","properties","serializeSpan","rawBlocks","keyedBlocks","listNestMode","serializers","opts","serializeNode","siblings","isInline","isList","isListItem","serializeListItem","findListItemIndex","isSpan","blockProps","serializeBlock","renderContainerOnSingleChild","containerProps","className","container","empty","getImageUrl","serializerOpts","serializeOptions","useDashedStyles","RawMarkSerializer","tag","types","style","img","src","strong","em","code","underline","textDecoration","link","href","blockType","serializer","markType","markFallback","hardBreak","undefined","child","serializedNode","hyperscript","getSerializers","renderNode","childNodes","blockContentToHyperscript","blocksToHyperScript","blocksToHtml","outerHTML","ProjectHandler","GLOBALS","favorites","savedProjects","log","getGLOBALS","addAsFavorite","removeFavorite","title","filter","saveFavoritesAsProject","projectName","tmpObj","name","cards","clearFavorites","deleteProject","loadProject","SANITY_PROJECT_ID","client","window","SanityClient","useCdn","fetch","then","renderPageContent","catch","phases","activePhaseFilter","cardsData","createGlobals","renderFilter","renderCards","renderDetailsPages","renderSavedProjectsDropdown","addSaveProjectButton","addClearProjectButton","card","phase","renderFavorites","projectElement","document","getElementById","addedCards","includes","firstChild","removeChild","createElement","innerHTML","itemRemove","append","addEventListener","prompt","showUserMessage","projectTemplate","projectsSelect","classList","add","emptyOption","project","option","setAttribute","event","filterTemplate","setPhaseFilter","cardsContainer","filteredCards","cardTemplate","subtitle","imageUrl","cardList","dataEntry","favBtn","location","body","overflow","preventDefault","stopPropagation","message","colorClass","setTimeout","remove","previous","next","currentId","substr","currentCard","querySelectorAll","currentKey","parseInt","entries","methodDetailsPages","hidden","which","cardDetailsPageTemplate","description","instruction","pageContainer","cardData","cardPage","e","path","history","replaceState","pageId","substring"],"mappings":"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","file":"main.5a5c7e17.js","sourceRoot":"..","sourcesContent":["/*!\n * Cross-Browser Split 1.1.1\n * Copyright 2007-2012 Steven Levithan <stevenlevithan.com>\n * Available under the MIT License\n * ECMAScript compliant, uniform cross-browser split method\n */\n\n/**\n * Splits a string into an array of strings using a regex or string separator. Matches of the\n * separator are not included in the result array. However, if `separator` is a regex that contains\n * capturing groups, backreferences are spliced into the result each time `separator` is matched.\n * Fixes browser bugs compared to the native `String.prototype.split` and can be used reliably\n * cross-browser.\n * @param {String} str String to split.\n * @param {RegExp|String} separator Regex or string to use for separating the string.\n * @param {Number} [limit] Maximum number of items to include in the result array.\n * @returns {Array} Array of substrings.\n * @example\n *\n * // Basic use\n * split('a b c d', ' ');\n * // -> ['a', 'b', 'c', 'd']\n *\n * // With limit\n * split('a b c d', ' ', 2);\n * // -> ['a', 'b']\n *\n * // Backreferences in result array\n * split('..word1 word2..', /([a-z]+)(\\d+)/i);\n * // -> ['..', 'word', '1', ' ', 'word', '2', '..']\n */\nmodule.exports = (function split(undef) {\n\n  var nativeSplit = String.prototype.split,\n    compliantExecNpcg = /()??/.exec(\"\")[1] === undef,\n    // NPCG: nonparticipating capturing group\n    self;\n\n  self = function(str, separator, limit) {\n    // If `separator` is not a regex, use `nativeSplit`\n    if (Object.prototype.toString.call(separator) !== \"[object RegExp]\") {\n      return nativeSplit.call(str, separator, limit);\n    }\n    var output = [],\n      flags = (separator.ignoreCase ? \"i\" : \"\") + (separator.multiline ? \"m\" : \"\") + (separator.extended ? \"x\" : \"\") + // Proposed for ES6\n      (separator.sticky ? \"y\" : \"\"),\n      // Firefox 3+\n      lastLastIndex = 0,\n      // Make `global` and avoid `lastIndex` issues by working with a copy\n      separator = new RegExp(separator.source, flags + \"g\"),\n      separator2, match, lastIndex, lastLength;\n    str += \"\"; // Type-convert\n    if (!compliantExecNpcg) {\n      // Doesn't need flags gy, but they don't hurt\n      separator2 = new RegExp(\"^\" + separator.source + \"$(?!\\\\s)\", flags);\n    }\n    /* Values for `limit`, per the spec:\n     * If undefined: 4294967295 // Math.pow(2, 32) - 1\n     * If 0, Infinity, or NaN: 0\n     * If positive number: limit = Math.floor(limit); if (limit > 4294967295) limit -= 4294967296;\n     * If negative number: 4294967296 - Math.floor(Math.abs(limit))\n     * If other: Type-convert, then use the above rules\n     */\n    limit = limit === undef ? -1 >>> 0 : // Math.pow(2, 32) - 1\n    limit >>> 0; // ToUint32(limit)\n    while (match = separator.exec(str)) {\n      // `separator.lastIndex` is not reliable cross-browser\n      lastIndex = match.index + match[0].length;\n      if (lastIndex > lastLastIndex) {\n        output.push(str.slice(lastLastIndex, match.index));\n        // Fix browsers whose `exec` methods don't consistently return `undefined` for\n        // nonparticipating capturing groups\n        if (!compliantExecNpcg && match.length > 1) {\n          match[0].replace(separator2, function() {\n            for (var i = 1; i < arguments.length - 2; i++) {\n              if (arguments[i] === undef) {\n                match[i] = undef;\n              }\n            }\n          });\n        }\n        if (match.length > 1 && match.index < str.length) {\n          Array.prototype.push.apply(output, match.slice(1));\n        }\n        lastLength = match[0].length;\n        lastLastIndex = lastIndex;\n        if (output.length >= limit) {\n          break;\n        }\n      }\n      if (separator.lastIndex === match.index) {\n        separator.lastIndex++; // Avoid an infinite loop\n      }\n    }\n    if (lastLastIndex === str.length) {\n      if (lastLength || !separator.test(\"\")) {\n        output.push(\"\");\n      }\n    } else {\n      output.push(str.slice(lastLastIndex));\n    }\n    return output.length > limit ? output.slice(0, limit) : output;\n  };\n\n  return self;\n})();\n","\nvar indexOf = [].indexOf;\n\nmodule.exports = function(arr, obj){\n  if (indexOf) return arr.indexOf(obj);\n  for (var i = 0; i < arr.length; ++i) {\n    if (arr[i] === obj) return i;\n  }\n  return -1;\n};","// contains, add, remove, toggle\nvar indexof = require('indexof')\n\nmodule.exports = ClassList\n\nfunction ClassList(elem) {\n    var cl = elem.classList\n\n    if (cl) {\n        return cl\n    }\n\n    var classList = {\n        add: add\n        , remove: remove\n        , contains: contains\n        , toggle: toggle\n        , toString: $toString\n        , length: 0\n        , item: item\n    }\n\n    return classList\n\n    function add(token) {\n        var list = getTokens()\n        if (indexof(list, token) > -1) {\n            return\n        }\n        list.push(token)\n        setTokens(list)\n    }\n\n    function remove(token) {\n        var list = getTokens()\n            , index = indexof(list, token)\n\n        if (index === -1) {\n            return\n        }\n\n        list.splice(index, 1)\n        setTokens(list)\n    }\n\n    function contains(token) {\n        return indexof(getTokens(), token) > -1\n    }\n\n    function toggle(token) {\n        if (contains(token)) {\n            remove(token)\n            return false\n        } else {\n            add(token)\n            return true\n        }\n    }\n\n    function $toString() {\n        return elem.className\n    }\n\n    function item(index) {\n        var tokens = getTokens()\n        return tokens[index] || null\n    }\n\n    function getTokens() {\n        var className = elem.className\n\n        return filter(className.split(\" \"), isTruthy)\n    }\n\n    function setTokens(list) {\n        var length = list.length\n\n        elem.className = list.join(\" \")\n        classList.length = length\n\n        for (var i = 0; i < list.length; i++) {\n            classList[i] = list[i]\n        }\n\n        delete list[length]\n    }\n}\n\nfunction filter (arr, fn) {\n    var ret = []\n    for (var i = 0; i < arr.length; i++) {\n        if (fn(arr[i])) ret.push(arr[i])\n    }\n    return ret\n}\n\nfunction isTruthy(value) {\n    return !!value\n}\n","var split = require('browser-split')\nvar ClassList = require('class-list')\n\nvar w = typeof window === 'undefined' ? require('html-element') : window\nvar document = w.document\nvar Text = w.Text\n\nfunction context () {\n\n  var cleanupFuncs = []\n\n  function h() {\n    var args = [].slice.call(arguments), e = null\n    function item (l) {\n      var r\n      function parseClass (string) {\n        // Our minimal parser doesn’t understand escaping CSS special\n        // characters like `#`. Don’t use them. More reading:\n        // https://mathiasbynens.be/notes/css-escapes .\n\n        var m = split(string, /([\\.#]?[^\\s#.]+)/)\n        if(/^\\.|#/.test(m[1]))\n          e = document.createElement('div')\n        forEach(m, function (v) {\n          var s = v.substring(1,v.length)\n          if(!v) return\n          if(!e)\n            e = document.createElement(v)\n          else if (v[0] === '.')\n            ClassList(e).add(s)\n          else if (v[0] === '#')\n            e.setAttribute('id', s)\n        })\n      }\n\n      if(l == null)\n        ;\n      else if('string' === typeof l) {\n        if(!e)\n          parseClass(l)\n        else\n          e.appendChild(r = document.createTextNode(l))\n      }\n      else if('number' === typeof l\n        || 'boolean' === typeof l\n        || l instanceof Date\n        || l instanceof RegExp ) {\n          e.appendChild(r = document.createTextNode(l.toString()))\n      }\n      //there might be a better way to handle this...\n      else if (isArray(l))\n        forEach(l, item)\n      else if(isNode(l))\n        e.appendChild(r = l)\n      else if(l instanceof Text)\n        e.appendChild(r = l)\n      else if ('object' === typeof l) {\n        for (var k in l) {\n          if('function' === typeof l[k]) {\n            if(/^on\\w+/.test(k)) {\n              (function (k, l) { // capture k, l in the closure\n                if (e.addEventListener){\n                  e.addEventListener(k.substring(2), l[k], false)\n                  cleanupFuncs.push(function(){\n                    e.removeEventListener(k.substring(2), l[k], false)\n                  })\n                }else{\n                  e.attachEvent(k, l[k])\n                  cleanupFuncs.push(function(){\n                    e.detachEvent(k, l[k])\n                  })\n                }\n              })(k, l)\n            } else {\n              // observable\n              e[k] = l[k]()\n              cleanupFuncs.push(l[k](function (v) {\n                e[k] = v\n              }))\n            }\n          }\n          else if(k === 'style') {\n            if('string' === typeof l[k]) {\n              e.style.cssText = l[k]\n            }else{\n              for (var s in l[k]) (function(s, v) {\n                if('function' === typeof v) {\n                  // observable\n                  e.style.setProperty(s, v())\n                  cleanupFuncs.push(v(function (val) {\n                    e.style.setProperty(s, val)\n                  }))\n                } else\n                  var match = l[k][s].match(/(.*)\\W+!important\\W*$/);\n                  if (match) {\n                    e.style.setProperty(s, match[1], 'important')\n                  } else {\n                    e.style.setProperty(s, l[k][s])\n                  }\n              })(s, l[k][s])\n            }\n          } else if(k === 'attrs') {\n            for (var v in l[k]) {\n              e.setAttribute(v, l[k][v])\n            }\n          }\n          else if (k.substr(0, 5) === \"data-\") {\n            e.setAttribute(k, l[k])\n          } else {\n            e[k] = l[k]\n          }\n        }\n      } else if ('function' === typeof l) {\n        //assume it's an observable!\n        var v = l()\n        e.appendChild(r = isNode(v) ? v : document.createTextNode(v))\n\n        cleanupFuncs.push(l(function (v) {\n          if(isNode(v) && r.parentElement)\n            r.parentElement.replaceChild(v, r), r = v\n          else\n            r.textContent = v\n        }))\n      }\n\n      return r\n    }\n    while(args.length)\n      item(args.shift())\n\n    return e\n  }\n\n  h.cleanup = function () {\n    for (var i = 0; i < cleanupFuncs.length; i++){\n      cleanupFuncs[i]()\n    }\n    cleanupFuncs.length = 0\n  }\n\n  return h\n}\n\nvar h = module.exports = context()\nh.context = context\n\nfunction isNode (el) {\n  return el && el.nodeName && el.nodeType\n}\n\nfunction forEach (arr, fn) {\n  if (arr.forEach) return arr.forEach(fn)\n  for (var i = 0; i < arr.length; i++) fn(arr[i], i)\n}\n\nfunction isArray (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]'\n}\n\n\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","var baseUrl = 'https://docs.sanity.io/help/'\n\nmodule.exports = function generateHelpUrl(slug) {\n  return baseUrl + slug\n}\n","// Convert an asset-id, asset or image to an image record suitable for processing\n// eslint-disable-next-line complexity\nexport default function parseSource(source) {\n  if (!source) {\n    return null\n  }\n\n  let image\n\n  if (typeof source === 'string' && isUrl(source)) {\n    // Someone passed an existing image url?\n    image = {\n      asset: {_ref: urlToId(source)}\n    }\n  } else if (typeof source === 'string') {\n    // Just an asset id\n    image = {\n      asset: {_ref: source}\n    }\n  } else if (typeof source._ref === 'string') {\n    // We just got passed an asset directly\n    image = {\n      asset: source\n    }\n  } else if (source._id) {\n    // If we were passed an image asset document\n    image = {\n      asset: {\n        _ref: source._id\n      }\n    }\n  } else if (source.asset && source.asset.url && !source.asset._ref) {\n    image = {\n      asset: {\n        _ref: urlToId(source.asset.url)\n      }\n    }\n  } else if (typeof source.asset === 'object') {\n    image = source\n  } else {\n    // We got something that does not look like an image, or it is an image\n    // that currently isn't sporting an asset.\n    return null\n  }\n\n  if (source.crop) {\n    image.crop = source.crop\n  }\n  if (source.hotspot) {\n    image.hotspot = source.hotspot\n  }\n\n  return applyDefaults(image)\n}\n\nfunction isUrl(url) {\n  return /^https?:\\/\\//.test(`${url}`)\n}\n\nfunction urlToId(url) {\n  const parts = url.split('/').slice(-1)\n  return `image-${parts[0]}`.replace(/\\.([a-z]+)$/, '-$1')\n}\n\n// Mock crop and hotspot if image lacks it\nfunction applyDefaults(image) {\n  if (image.crop && image.hotspot) {\n    return image\n  }\n\n  return {\n    crop: {\n      left: 0,\n      top: 0,\n      bottom: 0,\n      right: 0\n    },\n    hotspot: {\n      x: 0.5,\n      y: 0.5,\n      height: 1.0,\n      width: 1.0\n    },\n    ...image\n  }\n}\n","const example = 'image-Tb9Ew8CXIwaY6R1kjMvI0uRR-2000x3000-jpg'\n\nexport default function parseAssetId(ref) {\n  const [, id, dimensionString, format] = ref.split('-')\n\n  if (!id || !dimensionString || !format) {\n    throw new Error(`Malformed asset _ref '${ref}'. Expected an id like \"${example}\".`)\n  }\n\n  const [imgWidthStr, imgHeightStr] = dimensionString.split('x')\n\n  const width = +imgWidthStr\n  const height = +imgHeightStr\n\n  const isValidAssetId = isFinite(width) && isFinite(height)\n  if (!isValidAssetId) {\n    throw new Error(`Malformed asset _ref '${ref}'. Expected an id like \"${example}\".`)\n  }\n\n  return {id, width, height, format}\n}\n","import parseSource from './parseSource'\nimport parseAssetId from './parseAssetId'\n\nconst SPEC_NAME_TO_URL_NAME_MAPPINGS = [\n  ['width', 'w'],\n  ['height', 'h'],\n  ['format', 'fm'],\n  ['download', 'dl'],\n  ['blur', 'blur'],\n  ['sharpen', 'sharp'],\n  ['invert', 'invert'],\n  ['orientation', 'or'],\n  ['minHeight', 'min-h'],\n  ['maxHeight', 'max-h'],\n  ['minWidth', 'min-w'],\n  ['maxWidth', 'max-w'],\n  ['quality', 'q'],\n  ['fit', 'fit'],\n  ['crop', 'crop']\n]\n\nexport default function urlForImage(options) {\n  let spec = {...(options || {})}\n  const source = spec.source\n  delete spec.source\n\n  const image = parseSource(source)\n  if (!image) {\n    return null\n  }\n\n  const asset = parseAssetId(image.asset._ref)\n\n  // Compute crop rect in terms of pixel coordinates in the raw source image\n  const crop = {\n    left: Math.round(image.crop.left * asset.width),\n    top: Math.round(image.crop.top * asset.height)\n  }\n\n  crop.width = Math.round(asset.width - image.crop.right * asset.width - crop.left)\n  crop.height = Math.round(asset.height - image.crop.bottom * asset.height - crop.top)\n\n  // Compute hot spot rect in terms of pixel coordinates\n  const hotSpotVerticalRadius = (image.hotspot.height * asset.height) / 2\n  const hotSpotHorizontalRadius = (image.hotspot.width * asset.width) / 2\n  const hotSpotCenterX = image.hotspot.x * asset.width\n  const hotSpotCenterY = image.hotspot.y * asset.height\n  const hotspot = {\n    left: hotSpotCenterX - hotSpotHorizontalRadius,\n    top: hotSpotCenterY - hotSpotVerticalRadius,\n    right: hotSpotCenterX + hotSpotHorizontalRadius,\n    bottom: hotSpotCenterY + hotSpotHorizontalRadius\n  }\n\n  spec.asset = asset\n\n  // If irrelevant, or if we are requested to: don't perform crop/fit based on\n  // the crop/hotspot.\n  if (!(spec.rect || spec.focalPoint || spec.ignoreImageParams || spec.crop)) {\n    spec = {...spec, ...fit({crop, hotspot}, spec)}\n  }\n\n  return specToImageUrl(spec)\n}\n\n// eslint-disable-next-line complexity\nfunction specToImageUrl(spec) {\n  const cdnUrl = spec.baseUrl || 'https://cdn.sanity.io'\n  const filename = `${spec.asset.id}-${spec.asset.width}x${spec.asset.height}.${spec.asset.format}`\n  const baseUrl = `${cdnUrl}/images/${spec.projectId}/${spec.dataset}/${filename}`\n\n  const params = []\n\n  if (spec.rect) {\n    // Only bother url with a crop if it actually crops anything\n    const isEffectiveCrop =\n      spec.rect.left != 0 ||\n      spec.rect.top != 0 ||\n      spec.rect.height != spec.asset.height ||\n      spec.rect.width != spec.asset.width\n    if (isEffectiveCrop) {\n      params.push(`rect=${spec.rect.left},${spec.rect.top},${spec.rect.width},${spec.rect.height}`)\n    }\n  }\n\n  if (spec.bg) {\n    params.push(`bg=${spec.bg}`)\n  }\n\n  if (spec.focalPoint) {\n    params.push(`fp-x=${spec.focalPoint.x}`)\n    params.push(`fp-x=${spec.focalPoint.y}`)\n  }\n\n  if (spec.flipHorizontal || spec.flipVertical) {\n    params.push(`flip=${spec.flipHorizontal ? 'h' : ''}${spec.flipVertical ? 'v' : ''}`)\n  }\n\n  // Map from spec name to url param name, and allow using the actual param name as an alternative\n  SPEC_NAME_TO_URL_NAME_MAPPINGS.forEach(mapping => {\n    const [specName, param] = mapping\n    if (typeof spec[specName] !== 'undefined') {\n      params.push(`${param}=${encodeURIComponent(spec[specName])}`)\n    } else if (typeof spec[param] !== 'undefined') {\n      params.push(`${param}=${encodeURIComponent(spec[param])}`)\n    }\n  })\n\n  if (params.length === 0) {\n    return baseUrl\n  }\n\n  return `${baseUrl}?${params.join('&')}`\n}\n\nfunction fit(source, spec) {\n  const result = {\n    width: spec.width,\n    height: spec.height\n  }\n\n  // If we are not constraining the aspect ratio, we'll just use the whole crop\n  if (!(spec.width && spec.height)) {\n    result.rect = source.crop\n    return result\n  }\n\n  const crop = source.crop\n  const hotspot = source.hotspot\n\n  // If we are here, that means aspect ratio is locked and fitting will be a bit harder\n  const desiredAspectRatio = spec.width / spec.height\n  const cropAspectRatio = crop.width / crop.height\n\n  if (cropAspectRatio > desiredAspectRatio) {\n    // The crop is wider than the desired aspect ratio. That means we are cutting from the sides\n    const height = crop.height\n    const width = height * desiredAspectRatio\n    const top = crop.top\n    // Center output horizontally over hotspot\n    const hotspotXCenter = (hotspot.right - hotspot.left) / 2 + hotspot.left\n    let left = hotspotXCenter - width / 2\n    // Keep output within crop\n    if (left < crop.left) {\n      left = crop.left\n    } else if (left + width > crop.left + crop.width) {\n      left = crop.left + crop.width - width\n    }\n    result.rect = {\n      left: Math.round(left),\n      top: Math.round(top),\n      width: Math.round(width),\n      height: Math.round(height)\n    }\n    return result\n  }\n  // The crop is taller than the desired ratio, we are cutting from top and bottom\n  const width = crop.width\n  const height = width / desiredAspectRatio\n  const left = crop.left\n  // Center output vertically over hotspot\n  const hotspotYCenter = (hotspot.bottom - hotspot.top) / 2 + hotspot.top\n  let top = hotspotYCenter - height / 2\n  // Keep output rect within crop\n  if (top < crop.top) {\n    top = crop.top\n  } else if (top + height > crop.top + crop.height) {\n    top = crop.top + crop.height - height\n  }\n  result.rect = {\n    left: Math.max(0, Math.floor(left)),\n    top: Math.max(0, Math.floor(top)),\n    width: Math.round(width),\n    height: Math.round(height)\n  }\n  return result\n}\n\n// For backwards-compatibility\nexport {parseSource}\n","import urlForImage from './urlForImage'\n\nconst validFits = ['clip', 'crop', 'fill', 'fillmax', 'max', 'scale', 'min']\nconst validCrops = ['top', 'bottom', 'left', 'right', 'center', 'focalpoint', 'entropy']\n\nclass ImageUrlBuilder {\n  constructor(parent, options) {\n    if (parent) {\n      this.options = {...(parent.options || {}), ...(options || {})}\n    } else {\n      this.options = options || {}\n    }\n  }\n\n  withOptions(options) {\n    return new ImageUrlBuilder(this, options)\n  }\n\n  // The image to be represented. Accepts a Sanity 'image'-document, 'asset'-document or\n  // _id of asset. To get the benefit of automatic hot-spot/crop integration with the content\n  // studio, the 'image'-document must be provided.\n  image(source) {\n    return this.withOptions({source})\n  }\n\n  // Specify the dataset\n  dataset(dataset) {\n    return this.withOptions({dataset})\n  }\n\n  // Specify the projectId\n  projectId(projectId) {\n    return this.withOptions({projectId})\n  }\n\n  // Specify background color\n  bg(bg) {\n    return this.withOptions({bg})\n  }\n\n  // Specify the width of the image in pixels\n  width(width) {\n    return this.withOptions({width})\n  }\n\n  // Specify the height of the image in pixels\n  height(height) {\n    return this.withOptions({height})\n  }\n\n  // Specify focal point in fraction of image dimensions. Each component 0.0-1.0\n  focalPoint(x, y) {\n    return this.withOptions({focalPoint: {x, y}})\n  }\n\n  maxWidth(maxWidth) {\n    return this.withOptions({maxWidth})\n  }\n\n  minWidth(minWidth) {\n    return this.withOptions({minWidth})\n  }\n\n  maxHeight(maxHeight) {\n    return this.withOptions({maxHeight})\n  }\n\n  minHeight(minHeight) {\n    return this.withOptions({minHeight})\n  }\n\n  // Specify width and height in pixels\n  size(width, height) {\n    return this.withOptions({width, height})\n  }\n\n  // Specify blur between 0 and 100\n  blur(blur) {\n    return this.withOptions({blur})\n  }\n\n  sharpen(sharpen) {\n    return this.withOptions({sharpen})\n  }\n\n  // Specify the desired rectangle of the image\n  rect(left, top, width, height) {\n    return this.withOptions({rect: {left, top, width, height}})\n  }\n\n  // Specify the image format of the image. 'jpg', 'pjpg', 'png', 'webp'\n  format(format) {\n    return this.withOptions({format})\n  }\n\n  invert(invert) {\n    return this.withOptions({invert})\n  }\n\n  // Rotation in degrees 0, 90, 180, 270\n  orientation(orientation) {\n    return this.withOptions({orientation})\n  }\n\n  // Compression quality 0-100\n  quality(quality) {\n    return this.withOptions({quality})\n  }\n\n  // Make it a download link. Parameter is default filename.\n  forceDownload(download) {\n    return this.withOptions({download})\n  }\n\n  // Flip image horizontally\n  flipHorizontal() {\n    return this.withOptions({flipHorizontal: true})\n  }\n\n  // Flip image verically\n  flipVertical() {\n    return this.withOptions({flipVertical: true})\n  }\n\n  // Ignore crop/hotspot from image record, even when present\n  ignoreImageParams() {\n    return this.withOptions({ignoreImageParams: true})\n  }\n\n  fit(value) {\n    if (validFits.indexOf(value) === -1) {\n      throw new Error(`Invalid fit mode \"${value}\"`)\n    }\n\n    return this.withOptions({fit: value})\n  }\n\n  crop(value) {\n    if (validCrops.indexOf(value) === -1) {\n      throw new Error(`Invalid crop mode \"${value}\"`)\n    }\n\n    return this.withOptions({crop: value})\n  }\n\n  // Gets the url based on the submitted parameters\n  url() {\n    return urlForImage(this.options)\n  }\n\n  // Synonym for url()\n  toString() {\n    return this.url()\n  }\n}\n\nexport default function urlBuilder(options) {\n  // Did we get a SanityClient?\n  if (options && typeof options.clientConfig === 'object') {\n    // Inherit config from client\n    return new ImageUrlBuilder(null, {\n      baseUrl: options.clientConfig.apiHost.replace(/^https:\\/\\/api\\./, 'https://cdn.'),\n      projectId: options.clientConfig.projectId,\n      dataset: options.clientConfig.dataset\n    })\n  }\n\n  // Or just accept the options as given\n  return new ImageUrlBuilder(null, options)\n}\n","// eslint-disable-next-line import/no-commonjs\nmodule.exports = require('./lib/builder').default\n","const generateHelpUrl = require('@sanity/generate-help-url')\nconst urlBuilder = require('@sanity/image-url')\nconst objectAssign = require('object-assign')\n\nconst enc = encodeURIComponent\nconst materializeError = `You must either:\n  - Pass \\`projectId\\` and \\`dataset\\` to the block renderer\n  - Materialize images to include the \\`url\\` field.\n\nFor more information, see ${generateHelpUrl('block-content-image-materializing')}`\n\nconst getQueryString = options => {\n  const query = options.imageOptions\n  const keys = Object.keys(query)\n  if (!keys.length) {\n    return ''\n  }\n\n  const params = keys.map(key => `${enc(key)}=${enc(query[key])}`)\n  return `?${params.join('&')}`\n}\n\nconst buildUrl = props => {\n  const {node, options} = props\n  const {projectId, dataset} = options\n  const asset = node.asset\n\n  if (!asset) {\n    throw new Error('Image does not have required `asset` property')\n  }\n\n  if (asset.url) {\n    return asset.url + getQueryString(options)\n  }\n\n  if (!projectId || !dataset) {\n    throw new Error(materializeError)\n  }\n\n  const ref = asset._ref\n  if (!ref) {\n    throw new Error('Invalid image reference in block, no `_ref` found on `asset`')\n  }\n\n  return urlBuilder(objectAssign({projectId, dataset}, options.imageOptions || {}))\n    .image(node)\n    .toString()\n}\n\nmodule.exports = buildUrl\n","const defaultMarks = ['strong', 'em', 'code', 'underline', 'strike-through']\n\nconst buildMarksTree = block => {\n  const {children, markDefs} = block\n  if (!children || !children.length) {\n    return []\n  }\n\n  const sortedMarks = children.map(sortMarksByOccurences)\n  const rootNode = {_type: 'span', children: []}\n  let nodeStack = [rootNode]\n\n  children.forEach((span, i) => {\n    const marksNeeded = sortedMarks[i]\n    if (!marksNeeded) {\n      const lastNode = nodeStack[nodeStack.length - 1]\n      lastNode.children.push(span)\n      return\n    }\n\n    let pos = 1\n\n    // Start at position one. Root is always plain and should never be removed. (?)\n    if (nodeStack.length > 1) {\n      for (pos; pos < nodeStack.length; pos++) {\n        const mark = nodeStack[pos].markKey\n        const index = marksNeeded.indexOf(mark)\n        // eslint-disable-next-line max-depth\n        if (index === -1) {\n          break\n        }\n\n        marksNeeded.splice(index, 1)\n      }\n    }\n\n    // Keep from beginning to first miss\n    nodeStack = nodeStack.slice(0, pos)\n\n    // Add needed nodes\n    let currentNode = findLastParentNode(nodeStack)\n    marksNeeded.forEach(mark => {\n      const node = {\n        _type: 'span',\n        _key: span._key,\n        children: [],\n        mark: markDefs.find(def => def._key === mark) || mark,\n        markKey: mark\n      }\n\n      currentNode.children.push(node)\n      nodeStack.push(node)\n      currentNode = node\n    })\n\n    // Split at newlines to make individual line chunks, but keep newline\n    // characters as individual elements in the array. We use these characters\n    // in the span serializer to trigger hard-break rendering\n    if (isTextSpan(span)) {\n      const lines = span.text.split('\\n')\n      for (let line = lines.length; line-- > 1; ) {\n        lines.splice(line, 0, '\\n')\n      }\n\n      currentNode.children = currentNode.children.concat(lines)\n    } else {\n      currentNode.children = currentNode.children.concat(span)\n    }\n  })\n\n  return rootNode.children\n}\n\n// We want to sort all the marks of all the spans in the following order:\n// 1. Marks that are shared amongst the most adjacent siblings\n// 2. Non-default marks (links, custom metadata)\n// 3. Built-in, plain marks (bold, emphasis, code etc)\nfunction sortMarksByOccurences(span, i, spans) {\n  if (!span.marks || span.marks.length === 0) {\n    return span.marks || []\n  }\n\n  const markOccurences = span.marks.reduce((occurences, mark) => {\n    occurences[mark] = occurences[mark] ? occurences[mark] + 1 : 1\n\n    for (let siblingIndex = i + 1; siblingIndex < spans.length; siblingIndex++) {\n      const sibling = spans[siblingIndex]\n\n      if (sibling.marks && Array.isArray(sibling.marks) && sibling.marks.indexOf(mark) !== -1) {\n        occurences[mark]++\n      } else {\n        break\n      }\n    }\n\n    return occurences\n  }, {})\n\n  const sortByOccurence = sortMarks.bind(null, markOccurences)\n\n  // Slicing because sort() mutates the input\n  return span.marks.slice().sort(sortByOccurence)\n}\n\nfunction sortMarks(occurences, markA, markB) {\n  const aOccurences = occurences[markA] || 0\n  const bOccurences = occurences[markB] || 0\n\n  if (aOccurences !== bOccurences) {\n    return bOccurences - aOccurences\n  }\n\n  const aDefaultPos = defaultMarks.indexOf(markA)\n  const bDefaultPos = defaultMarks.indexOf(markB)\n\n  // Sort default marks last\n  if (aDefaultPos !== bDefaultPos) {\n    return aDefaultPos - bDefaultPos\n  }\n\n  // Sort other marks simply by key\n  if (markA < markB) {\n    return -1\n  } else if (markA > markB) {\n    return 1\n  }\n\n  return 0\n}\n\nfunction isTextSpan(node) {\n  return (\n    node._type === 'span' &&\n    typeof node.text === 'string' &&\n    (Array.isArray(node.marks) || typeof node.marks === 'undefined')\n  )\n}\n\nfunction findLastParentNode(nodes) {\n  for (let i = nodes.length - 1; i >= 0; i--) {\n    const node = nodes[i]\n    if (node._type === 'span' && node.children) {\n      return node\n    }\n  }\n\n  return undefined\n}\n\nmodule.exports = buildMarksTree\n","const objectAssign = require('object-assign')\n\n/* eslint-disable max-depth, complexity */\nfunction nestLists(blocks, mode = 'html') {\n  const tree = []\n  let currentList\n\n  for (let i = 0; i < blocks.length; i++) {\n    const block = blocks[i]\n    if (!isListBlock(block)) {\n      tree.push(block)\n      currentList = null\n      continue\n    }\n\n    // Start of a new list?\n    if (!currentList) {\n      currentList = listFromBlock(block)\n      tree.push(currentList)\n      continue\n    }\n\n    // New list item within same list?\n    if (blockMatchesList(block, currentList)) {\n      currentList.children.push(block)\n      continue\n    }\n\n    // Different list props, are we going deeper?\n    if (block.level > currentList.level) {\n      const newList = listFromBlock(block)\n\n      if (mode === 'html') {\n        // Because HTML is kinda weird, nested lists needs to be nested within list items\n        // So while you would think that we could populate the parent list with a new sub-list,\n        // We actually have to target the last list element (child) of the parent.\n        // However, at this point we need to be very careful - simply pushing to the list of children\n        // will mutate the input, and we don't want to blindly clone the entire tree.\n\n        // Clone the last child while adding our new list as the last child of it\n        const lastListItem = lastChild(currentList)\n        const newLastChild = objectAssign({}, lastListItem, {\n          children: lastListItem.children.concat(newList)\n        })\n\n        // Swap the last child\n        currentList.children[currentList.children.length - 1] = newLastChild\n      } else {\n        currentList.children.push(newList)\n      }\n\n      // Set the newly created, deeper list as the current\n      currentList = newList\n      continue\n    }\n\n    // Different list props, are we going back up the tree?\n    if (block.level < currentList.level) {\n      // Current list has ended, and we need to hook up with a parent of the same level and type\n      const match = findListMatching(tree[tree.length - 1], block)\n      if (match) {\n        currentList = match\n        currentList.children.push(block)\n        continue\n      }\n\n      // Similar parent can't be found, assume new list\n      currentList = listFromBlock(block)\n      tree.push(currentList)\n      continue\n    }\n\n    // Different list props, different list style?\n    if (block.listItem !== currentList.listItem) {\n      const match = findListMatching(tree[tree.length - 1], {level: block.level})\n      if (match && match.listItem === block.listItem) {\n        currentList = match\n        currentList.children.push(block)\n        continue\n      } else {\n        currentList = listFromBlock(block)\n        tree.push(currentList)\n        continue\n      }\n    }\n\n    // eslint-disable-next-line no-console\n    console.warn('Unknown state encountered for block', block)\n    tree.push(block)\n  }\n\n  return tree\n}\n\nfunction isListBlock(block) {\n  return Boolean(block.listItem)\n}\n\nfunction blockMatchesList(block, list) {\n  return block.level === list.level && block.listItem === list.listItem\n}\n\nfunction listFromBlock(block) {\n  return {\n    _type: 'list',\n    _key: `${block._key}-parent`,\n    level: block.level,\n    listItem: block.listItem,\n    children: [block]\n  }\n}\n\nfunction lastChild(block) {\n  return block.children && block.children[block.children.length - 1]\n}\n\nfunction findListMatching(rootNode, matching) {\n  const filterOnType = typeof matching.listItem === 'string'\n  if (\n    rootNode._type === 'list' &&\n    rootNode.level === matching.level &&\n    (filterOnType && rootNode.listItem === matching.listItem)\n  ) {\n    return rootNode\n  }\n\n  const node = lastChild(rootNode)\n  if (!node) {\n    return false\n  }\n\n  return findListMatching(node, matching)\n}\n\nmodule.exports = nestLists\n","const objectAssign = require('object-assign')\n\nmodule.exports = blocks => {\n  return blocks.map(block => {\n    if (block._key) {\n      return block\n    }\n\n    return objectAssign({_key: getStaticKey(block)}, block)\n  })\n}\n\nfunction getStaticKey(item) {\n  return checksum(JSON.stringify(item))\n    .toString(36)\n    .replace(/[^A-Za-z0-9]/g, '')\n}\n\n/* eslint-disable no-bitwise */\nfunction checksum(str) {\n  let hash = 0\n  const strlen = str.length\n  if (strlen === 0) {\n    return hash\n  }\n\n  for (let i = 0; i < strlen; i++) {\n    hash = (hash << 5) - hash + str.charCodeAt(i)\n    hash &= hash // Convert to 32bit integer\n  }\n\n  return hash\n}\n/* eslint-enable no-bitwise */\n","const objectAssign = require('object-assign')\nconst isDefined = val => typeof val !== 'undefined'\n\n// Recursively merge/replace default serializers with user-specified serializers\nmodule.exports = function mergeSerializers(defaultSerializers, userSerializers) {\n  return Object.keys(defaultSerializers).reduce((acc, key) => {\n    const type = typeof defaultSerializers[key]\n    if (type === 'function') {\n      acc[key] = isDefined(userSerializers[key]) ? userSerializers[key] : defaultSerializers[key]\n    } else if (type === 'object') {\n      acc[key] = objectAssign({}, defaultSerializers[key], userSerializers[key])\n    } else {\n      acc[key] =\n        typeof userSerializers[key] === 'undefined' ? defaultSerializers[key] : userSerializers[key]\n    }\n    return acc\n  }, {})\n}\n","const objectAssign = require('object-assign')\nconst buildMarksTree = require('./buildMarksTree')\nconst nestLists = require('./nestLists')\nconst generateKeys = require('./generateKeys')\nconst mergeSerializers = require('./mergeSerializers')\n\n// Properties to extract from props and pass to serializers as options\nconst optionProps = ['projectId', 'dataset', 'imageOptions']\nconst isDefined = val => typeof val !== 'undefined'\nconst defaults = {imageOptions: {}}\n\nfunction blocksToNodes(h, properties, defaultSerializers, serializeSpan) {\n  const props = objectAssign({}, defaults, properties)\n  const rawBlocks = Array.isArray(props.blocks) ? props.blocks : [props.blocks]\n  const keyedBlocks = generateKeys(rawBlocks)\n  const blocks = nestLists(keyedBlocks, props.listNestMode)\n  const serializers = mergeSerializers(defaultSerializers, props.serializers || {})\n\n  const options = optionProps.reduce((opts, key) => {\n    const value = props[key]\n    if (isDefined(value)) {\n      opts[key] = value\n    }\n    return opts\n  }, {})\n\n  function serializeNode(node, index, siblings, isInline) {\n    if (isList(node)) {\n      return serializeList(node)\n    }\n\n    if (isListItem(node)) {\n      return serializeListItem(node, findListItemIndex(node, siblings))\n    }\n\n    if (isSpan(node)) {\n      return serializeSpan(node, serializers, index, {serializeNode})\n    }\n\n    return serializeBlock(node, index, isInline)\n  }\n\n  function findListItemIndex(node, siblings) {\n    let index = 0\n    for (let i = 0; i < siblings.length; i++) {\n      if (siblings[i] === node) {\n        return index\n      }\n\n      if (!isListItem(siblings[i])) {\n        continue\n      }\n\n      index++\n    }\n\n    return index\n  }\n\n  function serializeBlock(block, index, isInline) {\n    const tree = buildMarksTree(block)\n    const children = tree.map((node, i, siblings) => serializeNode(node, i, siblings, true))\n    const blockProps = {\n      key: block._key || `block-${index}`,\n      node: block,\n      isInline,\n      serializers,\n      options\n    }\n\n    return h(serializers.block, blockProps, children)\n  }\n\n  function serializeListItem(block, index) {\n    const key = block._key\n    const tree = buildMarksTree(block)\n    const children = tree.map(serializeNode)\n    return h(serializers.listItem, {node: block, serializers, index, key, options}, children)\n  }\n\n  function serializeList(list) {\n    const type = list.listItem\n    const level = list.level\n    const key = list._key\n    const children = list.children.map(serializeNode)\n    return h(serializers.list, {key, level, type, options}, children)\n  }\n\n  // Default to false, so `undefined` will evaluate to the default here\n  const renderContainerOnSingleChild = Boolean(props.renderContainerOnSingleChild)\n\n  const nodes = blocks.map(serializeNode)\n  if (renderContainerOnSingleChild || nodes.length > 1) {\n    const containerProps = props.className ? {className: props.className} : {}\n    return h(serializers.container, containerProps, nodes)\n  }\n\n  if (nodes[0]) {\n    return nodes[0]\n  }\n\n  return typeof serializers.empty === 'function' ? h(serializers.empty) : serializers.empty\n}\n\nfunction isList(block) {\n  return block._type === 'list' && block.listItem\n}\n\nfunction isListItem(block) {\n  return block._type === 'block' && block.listItem\n}\n\nfunction isSpan(block) {\n  return typeof block === 'string' || block.marks || block._type === 'span'\n}\n\nmodule.exports = blocksToNodes\n","const objectAssign = require('object-assign')\nconst getImageUrl = require('./getImageUrl')\n\nmodule.exports = (h, serializerOpts) => {\n  const serializeOptions = serializerOpts || {useDashedStyles: false}\n\n  // Low-level block serializer\n  function BlockSerializer(props) {\n    const {node, serializers, options, isInline, children} = props\n    const blockType = node._type\n    const serializer = serializers.types[blockType]\n    if (!serializer) {\n      throw new Error(\n        `Unknown block type \"${blockType}\", please specify a serializer for it in the \\`serializers.types\\` prop`\n      )\n    }\n\n    return h(serializer, {node, options, isInline}, children)\n  }\n\n  // Low-level span serializer\n  function SpanSerializer(props) {\n    const {mark, children} = props.node\n    const isPlain = typeof mark === 'string'\n    const markType = isPlain ? mark : mark._type\n    const serializer = props.serializers.marks[markType]\n    if (!serializer) {\n      // @todo Revert back to throwing errors?\n      // eslint-disable-next-line no-console\n      console.warn(\n        `Unknown mark type \"${markType}\", please specify a serializer for it in the \\`serializers.marks\\` prop`\n      )\n      return h(props.serializers.markFallback, null, children)\n    }\n\n    return h(serializer, props.node, children)\n  }\n\n  // Low-level list serializer\n  function ListSerializer(props) {\n    const tag = props.type === 'bullet' ? 'ul' : 'ol'\n    return h(tag, null, props.children)\n  }\n\n  // Low-level list item serializer\n  function ListItemSerializer(props) {\n    const children =\n      !props.node.style || props.node.style === 'normal'\n        ? // Don't wrap plain text in paragraphs inside of a list item\n          props.children\n        : // But wrap any other style in whatever the block serializer says to use\n          h(props.serializers.types.block, props, props.children)\n\n    return h('li', null, children)\n  }\n\n  // Renderer of an actual block of type `block`. Confusing, we know.\n  function BlockTypeSerializer(props) {\n    const style = props.node.style || 'normal'\n\n    if (/^h\\d/.test(style)) {\n      return h(style, null, props.children)\n    }\n\n    return style === 'blockquote'\n      ? h('blockquote', null, props.children)\n      : h('p', null, props.children)\n  }\n\n  // Serializers for things that can be directly attributed to a tag without any props\n  // We use partial application to do this, passing the tag name as the first argument\n  function RawMarkSerializer(tag, props) {\n    return h(tag, null, props.children)\n  }\n\n  function UnderlineSerializer(props) {\n    const style = serializeOptions.useDashedStyles\n      ? {'text-decoration': 'underline'}\n      : {textDecoration: 'underline'}\n\n    return h('span', {style}, props.children)\n  }\n\n  function StrikeThroughSerializer(props) {\n    return h('del', null, props.children)\n  }\n\n  function LinkSerializer(props) {\n    return h('a', {href: props.mark.href}, props.children)\n  }\n\n  function ImageSerializer(props) {\n    if (!props.node.asset) {\n      return null\n    }\n\n    const img = h('img', {src: getImageUrl(props)})\n    return props.isInline ? img : h('figure', null, img)\n  }\n\n  // Serializer that recursively calls itself, producing a hyperscript tree of spans\n  function serializeSpan(span, serializers, index, options) {\n    if (span === '\\n' && serializers.hardBreak) {\n      return h(serializers.hardBreak, {key: `hb-${index}`})\n    }\n\n    if (typeof span === 'string') {\n      return serializers.text ? h(serializers.text, {key: `text-${index}`}, span) : span\n    }\n\n    let children\n    if (span.children) {\n      children = {\n        children: span.children.map((child, i) =>\n          options.serializeNode(child, i, span.children, true)\n        )\n      }\n    }\n\n    const serializedNode = objectAssign({}, span, children)\n\n    return h(serializers.span, {\n      key: span._key || `span-${index}`,\n      node: serializedNode,\n      serializers\n    })\n  }\n\n  const HardBreakSerializer = () => h('br')\n  const defaultMarkSerializers = {\n    strong: RawMarkSerializer.bind(null, 'strong'),\n    em: RawMarkSerializer.bind(null, 'em'),\n    code: RawMarkSerializer.bind(null, 'code'),\n    underline: UnderlineSerializer,\n    'strike-through': StrikeThroughSerializer,\n    link: LinkSerializer\n  }\n\n  const defaultSerializers = {\n    // Common overrides\n    types: {\n      block: BlockTypeSerializer,\n      image: ImageSerializer\n    },\n    marks: defaultMarkSerializers,\n\n    // Less common overrides\n    list: ListSerializer,\n    listItem: ListItemSerializer,\n\n    block: BlockSerializer,\n    span: SpanSerializer,\n    hardBreak: HardBreakSerializer,\n\n    // Container element\n    container: 'div',\n\n    // When we can't resolve the mark properly, use this renderer as the container\n    markFallback: 'span',\n\n    // Allow overriding text renderer, but leave undefined to just use plain strings by default\n    text: undefined,\n\n    // Empty nodes (React uses null, hyperscript with empty strings)\n    empty: ''\n  }\n\n  return {\n    defaultSerializers,\n    serializeSpan\n  }\n}\n","const hyperscript = require('hyperscript')\nconst objectAssign = require('object-assign')\nconst getImageUrl = require('./getImageUrl')\nconst blocksToNodes = require('./blocksToNodes')\nconst getSerializers = require('./serializers')\n\nconst renderNode = (serializer, properties, children) => {\n  const props = properties || {}\n  if (typeof serializer === 'function') {\n    return serializer(objectAssign({}, props, {children}))\n  }\n\n  const tag = serializer\n  const childNodes = props.children || children\n  return hyperscript(tag, props, childNodes)\n}\n\nconst {defaultSerializers, serializeSpan} = getSerializers(renderNode, {useDashedStyles: true})\n\nconst blockContentToHyperscript = options => {\n  return blocksToNodes(renderNode, options, defaultSerializers, serializeSpan)\n}\n\n// Expose default serializers to the user\nblockContentToHyperscript.defaultSerializers = defaultSerializers\n\n// Expose logic for building image URLs from an image reference/node\nblockContentToHyperscript.getImageUrl = getImageUrl\n\n// Expose node renderer\nblockContentToHyperscript.renderNode = renderNode\n\nmodule.exports = blockContentToHyperscript\n","const blocksToHyperScript = require('@sanity/block-content-to-hyperscript')\n\nconst h = blocksToHyperScript.renderNode\nconst blocksToHtml = options => {\n  const rootNode = blocksToHyperScript(options)\n  return rootNode.outerHTML || rootNode\n}\n\nblocksToHtml.defaultSerializers = blocksToHyperScript.defaultSerializers\nblocksToHtml.getImageUrl = blocksToHyperScript.getImageUrl\nblocksToHtml.renderNode = h\nblocksToHtml.h = h\n\nmodule.exports = blocksToHtml\n","let GLOBALS = {\n  favorites: [],\n  savedProjects: [],\n}\n\nconst ProjectHandler = {\n  test: () => {\n    console.log('O.K.')\n  },\n\n  getGLOBALS: () => {\n    return GLOBALS\n  },\n\n  addAsFavorite: (id) => {\n    if (GLOBALS.favorites.indexOf(id) >= 0) {\n      return 'Card already added to project';\n    }\n\n    GLOBALS.favorites.push(id)\n    return 'Added card to project';\n  },\n\n  removeFavorite: (title, id) => {\n    console.log(GLOBALS.favorites)\n    GLOBALS.favorites = GLOBALS.favorites.filter(item => {\n      return item !== id\n    });\n    console.log(GLOBALS.favorites)\n    return `Removed ${title} from project`;\n  },\n\n  saveFavoritesAsProject: (projectName) => {\n    let tmpObj = {\n      _id: `0${GLOBALS.savedProjects.length}`,\n      name: projectName,\n      cards: GLOBALS.favorites\n    }\n    GLOBALS.savedProjects.push(tmpObj);\n    return GLOBALS.savedProjects;\n  },\n\n  clearFavorites: () => {\n    GLOBALS.favorites = [];\n    return 'Cards cleared from working project';\n  },\n\n  deleteProject: () => {\n    // TODO\n  },\n\n  loadProject: (title) => {\n    let result = GLOBALS.savedProjects.filter(i => {\n      return i.name === title\n    });\n    if (result.length <= 0) {\n      return false\n    }\n    GLOBALS.favorites = result[0].cards;\n    return true;\n  },\n}\n\nexport default ProjectHandler;\n","import blocksToHtml from '@sanity/block-content-to-html'\nconst SANITY_PROJECT_ID = 'r1vilzq1'\nimport ProjectHandler from './projects.js'\n\n// SERVER COMMUNICATION -------------------------------------------------------------\n\n// Define the sanity communication module we call 'client'\nvar client = window.SanityClient({\n  projectId: SANITY_PROJECT_ID,\n  dataset: 'production',\n  useCdn: true\n})\n\n\n// Fetch all documents of type method. \"...\" means get all content in the method object. The following stuff makes sure we also fetch referenced files to get the image urls\nvar query = `*[_type==\"method\"]{\n  ...,\n  \"imageUrl\": image.asset->url,\n  \"phase\": phase->phaseTitle\n}`\n\n\nclient\n  .fetch(query) // Talk to server: request data based on query\n  .then(renderPageContent) // Send received data into renderCards function\n  .catch(()=>{ console.log(\"Error!\") }) // ...but if data fetch fails, do this\n\nlet GLOBALS = {\n  cards: [],\n  phases: ['All'],\n  activePhaseFilter: 'All',\n}\n\nfunction renderPageContent(cardsData) {\n  createGlobals(cardsData)\n  renderFilter()\n  renderCards(cardsData)\n  renderDetailsPages(cardsData)\n  renderSavedProjectsDropdown(ProjectHandler.getGLOBALS().savedProjects)\n  addSaveProjectButton()\n  addClearProjectButton()\n}\n\n// END of SERVER COMMUNICATION ---------------------------------------------------------\n\n// Some setup\n\nfunction createGlobals(cardsData) {\n  GLOBALS.cards = cardsData\n  GLOBALS.cards.map(card => {\n    if (GLOBALS.phases.indexOf(card.phase) < 0) {\n      GLOBALS.phases.push(card.phase)\n    }\n  })\n}\n\n// PAGE RENDERING ----------------------------------------------------------------------\nfunction renderFavorites() {\n  let projectElement = document.getElementById('favorites')\n  // Get favoritted cards from all cards\n  let favorites = ProjectHandler.getGLOBALS().favorites;\n  let addedCards = GLOBALS.cards.filter(card => {\n    return favorites.includes(card._id)\n  });\n  console.log(addedCards);\n\n  // Remove elements from html\n  while (projectElement.firstChild) {\n    projectElement.removeChild(projectElement.firstChild);\n  }\n\n  // Create elements\n  addedCards.map(card => {\n    let item = document.createElement('li');\n    item.innerHTML = card.title;\n    item.dataset['id'] = card._id;\n    let itemRemove = document.createElement('i');\n    item.append(itemRemove);\n    itemRemove.innerHTML = \"\\u24b3\";\n    itemRemove.addEventListener('click', () => {\n      ProjectHandler.removeFavorite(card.title, card._id);\n      renderFavorites()\n    });\n    projectElement.append(item);\n  });\n}\n\nfunction addSaveProjectButton() {\n  let button = document.getElementById('saveProject');\n  button.addEventListener('mousedown', () => {\n    let name = null\n    if (ProjectHandler.getGLOBALS().favorites.length > 0) {\n      name = prompt('Enter project name')\n    } else {\n      showUserMessage('No cards added to project', 'warning')\n      return\n    }\n    if (name !== null && name.length > 0) {\n      renderSavedProjectsDropdown(ProjectHandler.saveFavoritesAsProject(name))\n    } else {\n      showUserMessage('Project needs a name, try again', 'warning')\n    }\n  }, false)\n}\n\nfunction addClearProjectButton() {\n  let button = document.getElementById('clearProject');\n  button.addEventListener('mousedown', () => {\n    ProjectHandler.clearFavorites();\n    renderFavorites();\n  });\n}\n\nconst projectTemplate = (props) => {\n  return (`\n    <option data-title=\"${props}\">\n      ${props}\n    </option>\n  `)\n}\n\nfunction renderSavedProjectsDropdown(savedProjects) {\n  let container = document.getElementById('projects');\n\n  // Remove elements from html\n  while (container.firstChild) {\n    container.removeChild(container.firstChild);\n  }\n\n  let projectsSelect = document.createElement('select');\n  projectsSelect.classList.add('project-container');\n\n  let emptyOption = document.createElement('option');\n  emptyOption.classList.add('project-button')\n  emptyOption.innerHTML = projectTemplate('Projects')\n  projectsSelect.append(emptyOption)\n\n  savedProjects.map(project => {\n    let option = document.createElement('option');\n    option.classList.add('project-button')\n    option.setAttribute('value', project.name);\n    option.innerHTML = projectTemplate(project.name)\n    projectsSelect.append(option)\n  })\n\n  projectsSelect.addEventListener('change', loadProject)\n  document.getElementById('projects').append(projectsSelect)\n}\n\nfunction loadProject(event) {\n  if (ProjectHandler.loadProject(event.target.value)) {\n    renderFavorites();\n  }\n}\n\nconst filterTemplate = (props) => {\n  return (`\n    <option data-phase=\"${props}\">\n      ${props}\n    </option>\n  `)\n}\n\nfunction renderFilter() {\n  let filter = document.createElement('select')\n  filter.classList.add('filter-container')\n  GLOBALS.phases.map(phase => {\n    let option = document.createElement('option');\n    option.classList.add('filter-button')\n    option.setAttribute('value', phase);\n    option.innerHTML = filterTemplate(phase)\n    filter.append(option)\n  })\n  filter.addEventListener('change', setPhaseFilter)\n  document.getElementById('filter').append(filter)\n}\n\nfunction setPhaseFilter(event) {\n  if (event.target.value === GLOBALS.activePhaseFilter) return\n  GLOBALS.activePhaseFilter = event.target.value\n\n  // Remove cards before adding new\n  var cardsContainer = document.getElementById('cards');\n  while (cardsContainer.firstChild) {\n    cardsContainer.removeChild(cardsContainer.firstChild);\n  }\n\n  if (GLOBALS.activePhaseFilter === 'All') {\n    renderCards(GLOBALS.cards)\n  } else {\n    let filteredCards = GLOBALS.cards.filter(card => {\n      return card.phase === GLOBALS.activePhaseFilter\n    })\n    GLOBALS.filteredCards = filteredCards\n    renderCards(GLOBALS.filteredCards)\n  }\n\n}\n\nconst cardTemplate = (props) => {\n  return (`\n    <div class=card-text>\n      <span class=\"card-phase\">${props.phase}</span>\n      <h2 class=\"card-title\">${props.title}</h2>\n      <p class=\"card-subtext\">${props.subtitle}</p>\n    </div>\n\n    <div class=\"img-container\">\n      <img src=\"${props.imageUrl}?h=500\" class=\"card-image\">\n    </div>\n  `)\n}\n\n\n// Function to handle card rendering\nfunction renderCards (cardsData) {\n  // Generate a container element to collect generated cards\n  let cardList = document.createElement('div')\n  cardList.classList.add(\"cards-container\")\n\n  // Step through all entries in the 'data' array, generate html-elements and append to cardList container element\n  cardsData.map((dataEntry, key) => {\n    let card = document.createElement('div');\n    card.classList.add('card');\n    card.innerHTML = cardTemplate(dataEntry);\n    card.dataset['key'] = key;\n    card.dataset['hash'] = dataEntry._id;\n\n    let favBtn = document.createElement('button');\n    favBtn.innerHTML = 'Add to project';\n    favBtn.dataset['id'] = dataEntry._id;\n    card.append(favBtn);\n\n    cardList.append(card);\n\n    // Handle clicks on cards\n    card.addEventListener('click', (event) => {\n      window.location.hash = dataEntry._id;\n      document.body.style.overflow = 'hidden';\n    });\n\n    favBtn.addEventListener('click', (event) => {\n      event.preventDefault();\n      event.stopPropagation();\n      let result = ProjectHandler.addAsFavorite(event.target.dataset['id']);\n      showUserMessage(result);\n      renderFavorites();\n    });\n  })\n\n  // Add card container cardList to an element in the page\n  document.getElementById('cards').append(cardList)\n}\n\n// -- MESSAGES\n\nfunction showUserMessage(message, level) {\n  let container = document.getElementById('userMessage');\n  let colorClass = level || 'neutral';\n  container.classList.add('show');\n  container.classList.add(colorClass);\n\n  window.setTimeout(() => {\n    container.innerHTML = message;\n    window.setTimeout(() => {\n      container.classList.remove('show')\n      container.classList.remove(colorClass)\n      container.innerHTML = '';\n    }, 2000);\n  }, 300);\n}\n\nwindow.addEventListener('keyup', event => {\n  if (!window.location.hash) return false\n\n  let cardList = (GLOBALS.activePhaseFilter !== 'All')? GLOBALS.filteredCards : GLOBALS.cards\n  let currentId = window.location.hash.substr(1)\n  let currentCard = document.querySelectorAll(`[data-hash='${currentId}']`)[0]\n  let currentKey = parseInt(currentCard.dataset['key'])\n  let previous, next\n\n  if (currentKey === 0) {\n    previous = cardList.length - 1\n    next = currentKey + 1\n  } else if (currentKey === cardList.length - 1) {\n    previous = currentKey - 1\n    next = 0\n  } else {\n    previous = currentKey - 1\n    next = currentKey + 1\n  }\n\n  for (let page of Object.entries(window.methodDetailsPages)){\n    page[1].hidden = true\n  }\n\n  switch (event.which) {\n    case 39:\n      window.location.hash = cardList[next]._id\n      // Next card\n      break\n    case 37:\n      window.location.hash = cardList[previous]._id\n      // Previous card\n      break\n  }\n})\n\n// Card details pages\nconst cardDetailsPageTemplate = (props) => {\n  const description = blocksToHtml({\n    blocks: props.description\n  })\n\n  const instruction = blocksToHtml({\n    blocks: props.instruction\n  })\n\n  // These elements are injected into a div.method-page in the renderDetailsPages() function\n  return (`\n    <div class=\"method-page-inner\">\n      <span>${props.phase}</span>\n      <h1>${props.title}</h1>\n      <p>${props.subtitle}</p>\n      <div>\n        <h2>When to use it</h2>\n        ${description}\n      </div>\n      <div>\n        <h2>How to use it</h2>\n        ${instruction}\n      </div>\n      <div class=\"img-container\">\n        <img src=\"${props.imageUrl}?h=500\" class=\"card-image\">\n      </div>\n    </div>\n  `)\n}\n\n\n// Function to handle card rendering\nfunction renderDetailsPages (cardsData) {\n  let pageContainer = document.getElementById('page-container')\n  window.methodDetailsPages = {}\n\n  cardsData.map((cardData) => {\n    let cardPage = document.createElement('div')\n    cardPage.classList.add('method-page')\n    cardPage.innerHTML = cardDetailsPageTemplate(cardData)\n    cardPage.hidden = true\n\n    pageContainer.append(cardPage)\n\n    // Add the card page to globally available object attached to window object\n    window.methodDetailsPages[cardData._id] = cardPage\n  })\n\n  pageContainer.hidden = true\n}\n\n\n// When deselecting a page, ie clicking outside of the modal, hide the overlay\ndocument.getElementById('page-container').addEventListener('click', (e)=>{\n  document.body.style.overflow = 'auto';\n  if (e.path[0].id == 'page-container'){\n    document.getElementById('page-container').hidden = true\n\n    for (let page of Object.entries(window.methodDetailsPages)){\n      page[1].hidden = true\n    }\n\n    history.replaceState(null, null, ' ');\n  }\n})\n\n\n// Show the proper page when url changes (this is what makes tha modal appear)\nwindow.addEventListener('hashchange', ()=>{\n  document.getElementById('page-container').hidden = false\n  let pageId = window.location.hash.substring(1)\n  window.methodDetailsPages[pageId].hidden = false\n})\n\n// END of PAGE RENDERING -----------------------------------------------------------------\n"]}